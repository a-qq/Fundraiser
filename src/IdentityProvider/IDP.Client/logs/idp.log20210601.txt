2021-06-01 00:19:44.522 +02:00 [INF] Configuring web host ()...
2021-06-01 00:19:49.299 +02:00 [INF] Applying migrations ()...
2021-06-01 00:19:49.704 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:19:52.254 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:19:52.269 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:19:52.304 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:19:52.304 +02:00 [INF] Starting web host ()...
2021-06-01 00:19:52.456 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:19:52.472 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:19:52.476 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:19:52.679 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:19:52.834 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:19:52.886 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:19:52.913 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:19:52.921 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:19:52.931 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:19:52.938 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:19:52.947 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:19:52.957 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:19:52.964 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:19:52.972 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:19:52.983 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:19:53.015 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:19:53.027 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:19:53.045 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:19:53.055 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:19:53.066 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:19:53.085 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:19:53.096 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:19:53.134 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:19:53.147 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:19:53.163 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:19:53.177 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:19:58.743 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:19:58.895 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:19:58.901 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:19:58.943 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:19:59.400 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:19:59.476 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:19:59.476 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:19:59.478 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:19:59.490 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****DCDC","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"0D517991C9A8F2B2DA495957550EAFEB6FBE8E0EDC74D2962462BACF71FCDCDC","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"IfwR5pug4UYkqhbN-4YqqagcDrbRleuq_QgXOXJm7lU"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:19:59.529 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:19:59.532 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:19:59.563 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:20:12.451 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:20:12.801 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:23:02.403 +02:00 [INF] Configuring web host ()...
2021-06-01 00:23:07.806 +02:00 [INF] Applying migrations ()...
2021-06-01 00:23:08.272 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:23:12.475 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:23:12.489 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:23:12.529 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:23:12.529 +02:00 [INF] Starting web host ()...
2021-06-01 00:23:12.799 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:23:12.819 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:23:12.824 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:23:13.082 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:23:13.343 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:23:13.397 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:23:13.418 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:23:13.427 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:23:13.437 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:23:13.450 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:23:13.463 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:23:13.484 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:23:13.497 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:23:13.519 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:23:13.525 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:23:13.536 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:23:13.563 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:23:13.572 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:23:13.583 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:23:13.594 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:23:13.608 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:23:13.621 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:23:13.627 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:23:13.656 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:23:13.666 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:23:13.673 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:23:19.690 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:23:19.867 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:23:19.879 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:23:19.924 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:23:20.483 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:23:20.562 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:23:20.563 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:23:20.592 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:23:20.603 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****3F90","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"CB26B5AD155C7AAD7AD4F4FC338ED2160AF1D2FA945C0287EB5D48F814713F90","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"ZIc6ClpXQbQ1Ep95qV7xjM4F2s7gA1xmEOoasvrm9Vw"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:23:20.679 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:23:20.684 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:23:20.758 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:23:33.073 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:23:33.500 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:26:08.372 +02:00 [INF] Configuring web host ()...
2021-06-01 00:26:12.370 +02:00 [INF] Applying migrations ()...
2021-06-01 00:26:12.705 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:26:15.493 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:26:15.507 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:26:15.543 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:26:15.543 +02:00 [INF] Starting web host ()...
2021-06-01 00:26:15.910 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:26:15.930 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:26:15.940 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:26:16.138 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:26:16.272 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:26:16.333 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:26:16.352 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:26:16.376 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:26:16.389 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:26:16.398 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:26:16.406 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:26:16.416 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:26:16.424 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:26:16.432 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:26:16.444 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:26:16.453 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:26:16.469 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:26:16.479 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:26:16.490 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:26:16.512 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:26:16.526 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:26:16.537 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:26:16.543 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:26:16.572 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:26:16.579 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:26:16.589 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:26:22.182 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:26:22.373 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:26:22.387 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:26:22.437 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:26:23.041 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:26:23.109 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:26:23.109 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:26:23.121 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:26:23.131 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****A687","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"C0854EEE352D08FA1042E76A3DC98FF0C10A10B71972065BBB41EE558327A687","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"07WHkZqKYwRwOLxulE-1LXnyEd4NhnkIDWxJfysR1jM"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:26:23.172 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:26:23.175 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:26:23.222 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:26:32.304 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:26:32.703 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:33:33.692 +02:00 [INF] Configuring web host ()...
2021-06-01 00:33:37.077 +02:00 [INF] Applying migrations ()...
2021-06-01 00:33:37.472 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:33:40.708 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:33:40.723 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:33:40.760 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:33:40.760 +02:00 [INF] Starting web host ()...
2021-06-01 00:33:40.946 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:33:40.964 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:33:40.970 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:33:41.201 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:33:41.545 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:33:41.723 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:33:41.846 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:33:41.872 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:33:41.891 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:33:41.907 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:33:41.918 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:33:41.925 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:33:41.940 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:33:41.950 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:33:41.960 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:33:41.973 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:33:41.990 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:33:42.004 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:33:42.012 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:33:42.026 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:33:42.040 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:33:42.066 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:33:42.080 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:33:42.102 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:33:42.119 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:33:42.136 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:34:26.053 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:34:26.227 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:34:26.239 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:34:26.331 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:34:26.915 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:34:27.045 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:34:27.045 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:34:27.058 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:34:27.083 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****F60C","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"0C295E68D48E2DA88F929949D9B1B6DB0F9AFE8DBFC23A635CDC05C86548F60C","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"Txbj1zoZfD6BtRag8s0GytzWIHmazWhWW0KxUzTp4kA"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:34:27.173 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:34:27.177 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:34:27.248 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:34:50.793 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:34:51.274 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:40:43.707 +02:00 [INF] Configuring web host ()...
2021-06-01 00:40:49.024 +02:00 [INF] Applying migrations ()...
2021-06-01 00:40:49.497 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:40:52.957 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:40:52.979 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:40:53.022 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:40:53.023 +02:00 [INF] Starting web host ()...
2021-06-01 00:40:53.225 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:40:53.247 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:40:53.255 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:40:53.471 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:40:53.593 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:40:53.773 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:40:53.834 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:40:53.842 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:40:53.853 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:40:53.880 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:40:53.892 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:40:53.907 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:40:53.923 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:40:53.940 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:40:53.967 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:40:53.976 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:40:54.039 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:40:54.054 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:40:54.076 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:40:54.088 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:40:54.105 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:40:54.133 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:40:54.146 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:40:54.159 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:40:54.175 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:40:54.187 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:41:16.790 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:41:16.926 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:41:16.944 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:41:16.979 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:41:17.507 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:41:17.591 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:41:17.591 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:41:17.594 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:41:17.619 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****364A","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"639EC262CF2A2B6310A091AFB04BEDABCA59ECA295912733DABDB899CEBC364A","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"8k59Snb51a6CvvXQBd2MIKXhdJUsVbKr_MlZIs2sKdk"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:41:17.690 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:41:17.692 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:41:17.735 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:42:22.061 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:42:22.617 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:42:44.834 +02:00 [INF] Configuring web host ()...
2021-06-01 00:42:48.755 +02:00 [INF] Applying migrations ()...
2021-06-01 00:42:49.270 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:42:52.239 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:42:52.256 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:42:52.293 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:42:52.293 +02:00 [INF] Starting web host ()...
2021-06-01 00:42:52.463 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:42:52.481 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:42:52.486 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:42:52.756 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:42:52.893 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:42:52.944 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:42:52.960 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:42:52.991 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:42:53.006 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:42:53.016 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:42:53.027 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:42:53.044 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:42:53.053 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:42:53.060 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:42:53.073 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:42:53.086 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:42:53.096 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:42:53.107 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:42:53.119 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:42:53.142 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:42:53.155 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:42:53.166 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:42:53.176 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:42:53.183 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:42:53.194 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:42:53.201 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:43:08.838 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:43:09.012 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:43:09.039 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:43:09.087 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:43:09.686 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:43:09.770 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:43:09.771 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:43:09.775 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:43:09.818 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****72C8","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"0F5203DDEFE4F05496E55092CC7C3C6EEA8596D9502033808CDFDDA3C6C872C8","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"71iQWk4yrufXh91ZQeedHun4zfxbcTgrQpwO9N3P1Vs"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:43:09.889 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:43:09.892 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:43:09.940 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:43:30.999 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:43:31.381 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:51:12.005 +02:00 [INF] Configuring web host ()...
2021-06-01 00:51:14.793 +02:00 [INF] Applying migrations ()...
2021-06-01 00:51:15.128 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 00:51:17.731 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 00:51:17.745 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 00:51:17.776 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 00:51:17.776 +02:00 [INF] Starting web host ()...
2021-06-01 00:51:17.941 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 00:51:17.960 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 00:51:17.963 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 00:51:18.162 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 00:51:18.277 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 00:51:18.329 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 00:51:18.360 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 00:51:18.393 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 00:51:18.411 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 00:51:18.480 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 00:51:18.495 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 00:51:18.509 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 00:51:18.523 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 00:51:18.536 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 00:51:18.544 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 00:51:18.585 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 00:51:18.593 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 00:51:18.641 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 00:51:18.657 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 00:51:18.669 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 00:51:18.680 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 00:51:18.696 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 00:51:18.707 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 00:51:18.722 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 00:51:18.730 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 00:51:18.745 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 00:51:42.413 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 00:51:42.542 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:51:42.584 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:51:42.687 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:51:43.178 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 00:51:43.287 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 00:51:43.287 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 00:51:43.296 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 00:51:43.314 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****2160","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"25385A1918B1559680AB5658940E49A8CDCDB633FA12E0DCBCFA862C5DC52160","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"HT2mB1M6DUPEqiH8sSeebu2wUKoISVt4Im2Cm-D3mxw"},"$type":"TokenRequestValidationLog"}
2021-06-01 00:51:43.364 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 00:51:43.368 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 00:51:43.402 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 00:56:12.988 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 00:56:13.317 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 00:56:15.812 +02:00 [INF] ----- Handling integration event: "63c26d7c-2bc1-44e1-9838-da50e138b0ba" at IDP.Application - ({"MemberId":"49098504-3c64-41d1-8287-cbf46849bd5d","Email":"deseni3696@jmpant.com","Role":"Headmaster","SchoolId":"a447f3de-30e5-4a29-885b-7621c7d5598c","FirstName":"Staszek","LastName":"Kowalski","Gender":"Male","Id":"63c26d7c-2bc1-44e1-9838-da50e138b0ba","CreationDate":"2021-05-31T22:56:14.7890680Z","$type":"MemberEnrolledIntegrationEvent"})
2021-06-01 00:56:15.919 +02:00 [INF] ----- Begin transaction "3abe84e3-646c-4734-8802-03b237dd0850" for IdentifiedCommand<AddUserCommand> ({"Command":{"Email":"deseni3696@jmpant.com","Subject":"49098504-3c64-41d1-8287-cbf46849bd5d","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"a447f3de-30e5-4a29-885b-7621c7d5598c","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"},"Id":"63c26d7c-2bc1-44e1-9838-da50e138b0ba","$type":"IdentifiedCommand`1"})
2021-06-01 00:56:16.087 +02:00 [ERR] ERROR Handling transaction for IdentifiedCommand<AddUserCommand> ({"Command":{"Email":"deseni3696@jmpant.com","Subject":"49098504-3c64-41d1-8287-cbf46849bd5d","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"a447f3de-30e5-4a29-885b-7621c7d5598c","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"},"Id":"63c26d7c-2bc1-44e1-9838-da50e138b0ba","$type":"IdentifiedCommand`1"})
System.InvalidOperationException: Handler was not found for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
2021-06-01 00:56:16.273 +02:00 [ERR] ----- Request IdentifiedCommand<AddUserCommand> failed with exception!
System.InvalidOperationException: Handler was not found for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
   at IDP.Application.Common.Behaviors.UnhandledExceptionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\UnhandledExceptionBehaviour.cs:line 25
2021-06-01 00:56:16.516 +02:00 [ERR] Dead lettering RabbitMQ message: "{"MemberId":"49098504-3c64-41d1-8287-cbf46849bd5d","Email":"deseni3696@jmpant.com","Role":"Headmaster","SchoolId":"a447f3de-30e5-4a29-885b-7621c7d5598c","FirstName":"Staszek","LastName":"Kowalski","Gender":"Male","Id":"63c26d7c-2bc1-44e1-9838-da50e138b0ba","CreationDate":"2021-05-31T22:56:14.789068Z"}". Reason: Handler was not found for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
System.InvalidOperationException: Handler was not found for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
   at IDP.Application.Common.Behaviors.UnhandledExceptionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\UnhandledExceptionBehaviour.cs:line 25
   at IDP.Application.IntegrationEvents.Handlers.MemberEnrolledIntegrationEventHandler.Handle(MemberEnrolledIntegrationEvent event) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\IntegrationEvents\Handlers\MemberEnrolledIntegrationEventHandler.cs:line 50
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.HandleTypedSubscription(String eventName, String message, ILifetimeScope scope, SubscriptionInfo subscription, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 346
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.ProcessEvent(String eventName, String message, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 311
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.ProcessEvent(String eventName, String message, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 317
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.Consumer_Received(Object sender, BasicDeliverEventArgs eventArgs) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 225
2021-06-01 01:05:10.817 +02:00 [INF] Configuring web host ()...
2021-06-01 01:05:13.982 +02:00 [INF] Applying migrations ()...
2021-06-01 01:05:14.330 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 01:05:16.992 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 01:05:17.006 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 01:05:17.040 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 01:05:17.040 +02:00 [INF] Starting web host ()...
2021-06-01 01:05:17.221 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 01:05:17.236 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 01:05:17.240 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 01:05:17.492 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 01:05:17.681 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 01:05:17.840 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 01:05:17.866 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 01:05:17.887 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 01:05:17.897 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 01:05:17.908 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 01:05:17.924 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 01:05:17.934 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 01:05:17.946 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 01:05:17.957 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 01:05:17.966 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 01:05:17.997 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 01:05:18.019 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 01:05:18.036 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 01:05:18.058 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 01:05:18.070 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 01:05:18.080 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 01:05:18.087 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 01:05:18.096 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 01:05:18.104 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 01:05:18.115 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 01:05:18.129 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 01:06:06.597 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 01:06:06.724 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 01:06:06.750 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 01:06:06.804 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 01:06:07.357 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 01:06:07.472 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 01:06:07.473 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 01:06:07.476 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 01:06:07.491 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****7928","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"E041CD6F7197E601B2EC9D4F26EB857352F4CDBB1161A2890666AD653DC87928","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"_JRUPVuHGSCWiMaqqMh37l3_3ndeZqO6fq9QqiUKKMY"},"$type":"TokenRequestValidationLog"}
2021-06-01 01:06:07.535 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 01:06:07.537 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 01:06:07.571 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 01:07:51.923 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 01:07:52.262 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 01:07:54.716 +02:00 [INF] ----- Handling integration event: "2d498044-2f6a-45ad-af33-6c41beeb122c" at IDP.Application - ({"MemberId":"942f04ab-980d-4c3e-8c5a-e36c0b97c6ed","Email":"hicag54080@jmpant.com","Role":"Headmaster","SchoolId":"d0ae6770-593c-415a-84d9-597125727d05","FirstName":"Staszek","LastName":"Kowalski","Gender":"Male","Id":"2d498044-2f6a-45ad-af33-6c41beeb122c","CreationDate":"2021-05-31T23:07:53.8374531Z","$type":"MemberEnrolledIntegrationEvent"})
2021-06-01 01:07:54.852 +02:00 [INF] ----- Begin transaction "ba281537-130b-4c94-b3ce-2f9a24598511" for IdentifiedCommand<AddUserCommand> ({"Command":{"Email":"hicag54080@jmpant.com","Subject":"942f04ab-980d-4c3e-8c5a-e36c0b97c6ed","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"d0ae6770-593c-415a-84d9-597125727d05","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"},"Id":"2d498044-2f6a-45ad-af33-6c41beeb122c","$type":"IdentifiedCommand`1"})
2021-06-01 01:09:37.510 +02:00 [ERR] ERROR Handling transaction for IdentifiedCommand<AddUserCommand> ({"Command":{"Email":"hicag54080@jmpant.com","Subject":"942f04ab-980d-4c3e-8c5a-e36c0b97c6ed","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"d0ae6770-593c-415a-84d9-597125727d05","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"},"Id":"2d498044-2f6a-45ad-af33-6c41beeb122c","$type":"IdentifiedCommand`1"})
System.InvalidOperationException: Error constructing handler for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
 ---> Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'MediatR.IRequestHandler`2[[IDP.Application.Common.Models.IdentifiedCommand`1[[IDP.Application.Users.Commands.AddUser.AddUserCommand, IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CSharpFunctionalExtensions.Result, CSharpFunctionalExtensions, Version=2.13.3.0, Culture=neutral, PublicKeyToken=null]]' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at IDP.Application.MediatorModule.<>c__DisplayClass3_0.<Load>b__1(Type t) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\MediatorModule.cs:line 39
   at MediatR.ServiceFactoryExtensions.GetInstance[T](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   --- End of inner exception stack trace ---
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
2021-06-01 01:09:37.731 +02:00 [ERR] ----- Request IdentifiedCommand<AddUserCommand> failed with exception!
System.InvalidOperationException: Error constructing handler for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
 ---> Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'MediatR.IRequestHandler`2[[IDP.Application.Common.Models.IdentifiedCommand`1[[IDP.Application.Users.Commands.AddUser.AddUserCommand, IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CSharpFunctionalExtensions.Result, CSharpFunctionalExtensions, Version=2.13.3.0, Culture=neutral, PublicKeyToken=null]]' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at IDP.Application.MediatorModule.<>c__DisplayClass3_0.<Load>b__1(Type t) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\MediatorModule.cs:line 39
   at MediatR.ServiceFactoryExtensions.GetInstance[T](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   --- End of inner exception stack trace ---
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
   at IDP.Application.Common.Behaviors.UnhandledExceptionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\UnhandledExceptionBehaviour.cs:line 25
2021-06-01 01:09:38.033 +02:00 [ERR] Dead lettering RabbitMQ message: "{"MemberId":"942f04ab-980d-4c3e-8c5a-e36c0b97c6ed","Email":"hicag54080@jmpant.com","Role":"Headmaster","SchoolId":"d0ae6770-593c-415a-84d9-597125727d05","FirstName":"Staszek","LastName":"Kowalski","Gender":"Male","Id":"2d498044-2f6a-45ad-af33-6c41beeb122c","CreationDate":"2021-05-31T23:07:53.8374531Z"}". Reason: Error constructing handler for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
System.InvalidOperationException: Error constructing handler for request of type MediatR.IRequestHandler`2[IDP.Application.Common.Models.IdentifiedCommand`1[IDP.Application.Users.Commands.AddUser.AddUserCommand],CSharpFunctionalExtensions.Result]. Register your handlers with the container. See the samples in GitHub for examples.
 ---> Autofac.Core.Registration.ComponentNotRegisteredException: The requested service 'MediatR.IRequestHandler`2[[IDP.Application.Common.Models.IdentifiedCommand`1[[IDP.Application.Users.Commands.AddUser.AddUserCommand, IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], IDP.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CSharpFunctionalExtensions.Result, CSharpFunctionalExtensions, Version=2.13.3.0, Culture=neutral, PublicKeyToken=null]]' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType)
   at IDP.Application.MediatorModule.<>c__DisplayClass3_0.<Load>b__1(Type t) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\MediatorModule.cs:line 39
   at MediatR.ServiceFactoryExtensions.GetInstance[T](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   --- End of inner exception stack trace ---
   at MediatR.Internal.RequestHandlerBase.GetHandler[THandler](ServiceFactory factory)
   at MediatR.Internal.RequestHandlerWrapperImpl`2.<>c__DisplayClass1_0.<Handle>g__Handler|0()
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.<>c__DisplayClass4_0.<<Handle>b__0>d.MoveNext() in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 60
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c.<<ExecuteAsync>b__3_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at IDP.Application.Common.Behaviors.TransactionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\TransactionBehaviour.cs:line 50
   at IDP.Application.Common.Behaviors.UnhandledExceptionBehaviour`2.Handle(TRequest request, CancellationToken cancellationToken, RequestHandlerDelegate`1 next) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\Common\Behaviors\UnhandledExceptionBehaviour.cs:line 25
   at IDP.Application.IntegrationEvents.Handlers.MemberEnrolledIntegrationEventHandler.Handle(MemberEnrolledIntegrationEvent event) in C:\Users\aqq\source\repos\FundraiserBackend\src\IdentityProvider\IDP.Application\IntegrationEvents\Handlers\MemberEnrolledIntegrationEventHandler.cs:line 50
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.HandleTypedSubscription(String eventName, String message, ILifetimeScope scope, SubscriptionInfo subscription, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 346
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.ProcessEvent(String eventName, String message, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 311
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.ProcessEvent(String eventName, String message, String dlxReason) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 317
   at SharedKernel.Infrastructure.Concretes.EventBus.RabbitMQ.EventBusRabbitMq.Consumer_Received(Object sender, BasicDeliverEventArgs eventArgs) in C:\Users\aqq\source\repos\FundraiserBackend\src\SharedKernel\SharedKernel.Infrastructure\Concretes\EventBus\RabbitMQ\EventBusRabbitMq.cs:line 225
2021-06-01 01:23:04.612 +02:00 [INF] Configuring web host ()...
2021-06-01 01:23:07.335 +02:00 [INF] Applying migrations ()...
2021-06-01 01:23:07.637 +02:00 [INF] Migrating database associated with context IdentityDbContext
2021-06-01 01:23:10.421 +02:00 [INF] Migrated database associated with context IdentityDbContext
2021-06-01 01:23:10.435 +02:00 [INF] Migrating database associated with context IntegrationEventLogContext
2021-06-01 01:23:10.500 +02:00 [INF] Migrated database associated with context IntegrationEventLogContext
2021-06-01 01:23:10.501 +02:00 [INF] Starting web host ()...
2021-06-01 01:23:10.706 +02:00 [INF] Starting IdentityServer4 version 4.1.1+cebd52f5bc61bdefc262fd20739d4d087c6f961f
2021-06-01 01:23:10.725 +02:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2021-06-01 01:23:10.729 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2021-06-01 01:23:11.119 +02:00 [INF] RabbitMQ Client is trying to connect
2021-06-01 01:23:11.360 +02:00 [INF] RabbitMQ Client acquired a persistent connection to 'localhost' and is subscribed to failure events
2021-06-01 01:23:11.459 +02:00 [INF] Subscribing to event FormTutorAssignedIntegrationEvent with IIntegrationEventHandler<FormTutorAssignedIntegrationEvent>
2021-06-01 01:23:11.497 +02:00 [INF] Subscribing to event FormTutorDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorDivestedIntegrationEvent>
2021-06-01 01:23:11.536 +02:00 [INF] Subscribing to event FormTutorsDivestedIntegrationEvent with IIntegrationEventHandler<FormTutorsDivestedIntegrationEvent>
2021-06-01 01:23:11.688 +02:00 [INF] Subscribing to event HeadmasterDivestedIntegrationEvent with IIntegrationEventHandler<HeadmasterDivestedIntegrationEvent>
2021-06-01 01:23:11.714 +02:00 [INF] Subscribing to event HeadmasterPromotedIntegrationEvent with IIntegrationEventHandler<HeadmasterPromotedIntegrationEvent>
2021-06-01 01:23:11.754 +02:00 [INF] Subscribing to event MemberArchivedIntegrationEvent with IIntegrationEventHandler<MemberArchivedIntegrationEvent>
2021-06-01 01:23:11.824 +02:00 [INF] Subscribing to event MemberEnrolledIntegrationEvent with IIntegrationEventHandler<MemberEnrolledIntegrationEvent>
2021-06-01 01:23:11.991 +02:00 [INF] Subscribing to event MemberExpelledIntegrationEvent with IIntegrationEventHandler<MemberExpelledIntegrationEvent>
2021-06-01 01:23:11.998 +02:00 [INF] Subscribing to event MemberRestoredIntegrationEvent with IIntegrationEventHandler<MemberRestoredIntegrationEvent>
2021-06-01 01:23:12.004 +02:00 [INF] Subscribing to event MembersArchivedIntegrationEvent with IIntegrationEventHandler<MembersArchivedIntegrationEvent>
2021-06-01 01:23:12.016 +02:00 [INF] Subscribing to event MembersEnrolledIntegrationEvent with IIntegrationEventHandler<MembersEnrolledIntegrationEvent>
2021-06-01 01:23:12.051 +02:00 [INF] Subscribing to event SchoolRemovedIntegrationEvent with IIntegrationEventHandler<SchoolRemovedIntegrationEvent>
2021-06-01 01:23:12.062 +02:00 [INF] Subscribing to event StudentAssignedIntegrationEvent with IIntegrationEventHandler<StudentAssignedIntegrationEvent>
2021-06-01 01:23:12.072 +02:00 [INF] Subscribing to event StudentDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentDisenrolledIntegrationEvent>
2021-06-01 01:23:12.082 +02:00 [INF] Subscribing to event StudentsDisenrolledIntegrationEvent with IIntegrationEventHandler<StudentsDisenrolledIntegrationEvent>
2021-06-01 01:23:12.101 +02:00 [INF] Subscribing to event StudentsAssignedIntegrationEvent with IIntegrationEventHandler<StudentsAssignedIntegrationEvent>
2021-06-01 01:23:12.131 +02:00 [INF] Subscribing to event TreasurerDivestedIntegrationEvent with IIntegrationEventHandler<TreasurerDivestedIntegrationEvent>
2021-06-01 01:23:12.151 +02:00 [INF] Subscribing to event TreasurersDivestedIntegrationEvent with IIntegrationEventHandler<TreasurersDivestedIntegrationEvent>
2021-06-01 01:23:12.163 +02:00 [INF] Subscribing to event TreasurerPromotedIntegrationEvent with IIntegrationEventHandler<TreasurerPromotedIntegrationEvent>
2021-06-01 01:23:12.178 +02:00 [INF] Subscribing to event PasswordResetRequestedIntegrationEvent with IIntegrationEventHandler<PasswordResetRequestedIntegrationEvent>
2021-06-01 01:23:12.192 +02:00 [INF] Subscribing to event UserRegistrationRequestedIntegrationEvent with IIntegrationEventHandler<UserRegistrationRequestedIntegrationEvent>
2021-06-01 01:23:22.660 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2021-06-01 01:23:22.802 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 01:23:22.821 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 01:23:22.851 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 01:23:23.486 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2021-06-01 01:23:23.571 +02:00 [INF] ----- Validating command IsUserActiveQuery
2021-06-01 01:23:23.571 +02:00 [INF] ----- Handling internal query IsUserActiveQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"IsUserActiveQuery"})
2021-06-01 01:23:23.574 +02:00 [INF] ----- Internal query IsUserActiveQuery handled successfully - response: true
2021-06-01 01:23:23.587 +02:00 [INF] Token request validation success, {"ClientId":"fundraiserapi_swagger","ClientName":"Backend.API - Swagger","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****6B8C","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","code":"BF9ADE33298B31257040415E911229239DDB89AFA00456CD11AD34FBF9006B8C","client_id":"fundraiserapi_swagger","redirect_uri":"https://localhost:44307/swagger/oauth2-redirect.html","code_verifier":"MNiIWIuJVacQ7sN7lSDLGNzbD3DwMg8UvdtVgKqkyZw"},"$type":"TokenRequestValidationLog"}
2021-06-01 01:23:23.640 +02:00 [INF] ----- Validating command GetUserClaimsQuery
2021-06-01 01:23:23.643 +02:00 [INF] ----- Handling internal query GetUserClaimsQuery ({"Subject":"3f0b0a5f-7aa6-46f4-9247-3ef9a9df2407","$type":"GetUserClaimsQuery"})
2021-06-01 01:23:23.705 +02:00 [INF] ----- Internal query GetUserClaimsQuery handled successfully - response: [{"Type":"role","Value":"Administrator","$type":"ClaimDto"}]
2021-06-01 01:23:41.582 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2021-06-01 01:23:42.118 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2021-06-01 01:23:45.176 +02:00 [INF] ----- Handling integration event: "0bed949f-089d-4515-a860-9a0d1c7e0e4c" at IDP.Application - ({"MemberId":"20703fda-66da-492e-b9b0-8e2ec0709b53","Email":"kexex66313@jmpant.com","Role":"Headmaster","SchoolId":"edb9e15b-0834-49d2-9d58-dd37624323a7","FirstName":"Staszek","LastName":"Kowalski","Gender":"Male","Id":"0bed949f-089d-4515-a860-9a0d1c7e0e4c","CreationDate":"2021-05-31T23:23:44.0039228Z","$type":"MemberEnrolledIntegrationEvent"})
2021-06-01 01:23:45.327 +02:00 [INF] ----- Begin transaction "3b55a451-37da-42cc-a988-acd0fa4f0db3" for IdentifiedCommand<AddUserCommand> ({"Command":{"Email":"kexex66313@jmpant.com","Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"edb9e15b-0834-49d2-9d58-dd37624323a7","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"},"Id":"0bed949f-089d-4515-a860-9a0d1c7e0e4c","$type":"IdentifiedCommand`1"})
2021-06-01 01:23:46.349 +02:00 [INF] ----- Sending idempotent command: AddUserCommand - Id: "0bed949f-089d-4515-a860-9a0d1c7e0e4c" ({"Email":"kexex66313@jmpant.com","Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"edb9e15b-0834-49d2-9d58-dd37624323a7","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"})
2021-06-01 01:23:46.387 +02:00 [INF] ----- Validating command AddUserCommand
2021-06-01 01:23:46.439 +02:00 [INF] ----- Handling internal command AddUserCommand ({"Email":"kexex66313@jmpant.com","Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"edb9e15b-0834-49d2-9d58-dd37624323a7","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"})
2021-06-01 01:23:46.559 +02:00 [INF] ----- Internal command AddUserCommand handled successfully!
2021-06-01 01:23:46.560 +02:00 [INF] ----- Idempotent command succeeded - AddUserCommand - Id: "0bed949f-089d-4515-a860-9a0d1c7e0e4c" ({"Email":"kexex66313@jmpant.com","Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","HoursToExpire":null,"Claims":[{"Type":"role","Value":"Headmaster","$type":"ClaimInsertModel"},{"Type":"school_id","Value":"edb9e15b-0834-49d2-9d58-dd37624323a7","$type":"ClaimInsertModel"},{"Type":"given_name","Value":"Staszek","$type":"ClaimInsertModel"},{"Type":"family_name","Value":"Kowalski","$type":"ClaimInsertModel"},{"Type":"gender","Value":"Male","$type":"ClaimInsertModel"}],"$type":"AddUserCommand"})
2021-06-01 01:23:46.560 +02:00 [INF] ----- Commit transaction "3b55a451-37da-42cc-a988-acd0fa4f0db3" for IdentifiedCommand<AddUserCommand>
2021-06-01 01:23:46.605 +02:00 [INF] Publishing domain event. Event - UserRegistrationRequestedDomainEvent
2021-06-01 01:23:46.616 +02:00 [INF] ----- Enqueuing integration event "8276e1f4-9a79-4b80-a25e-55b72ff1ae19" to repository ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","Id":"8276e1f4-9a79-4b80-a25e-55b72ff1ae19","CreationDate":"2021-05-31T23:23:46.6128536Z","$type":"UserRegistrationRequestedIntegrationEvent"})
2021-06-01 01:23:46.854 +02:00 [INF] ----- Publishing integration event: "8276e1f4-9a79-4b80-a25e-55b72ff1ae19" from IDP.Application - ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","Id":"8276e1f4-9a79-4b80-a25e-55b72ff1ae19","CreationDate":"2021-05-31T23:23:46.6128536Z","$type":"UserRegistrationRequestedIntegrationEvent"})
2021-06-01 01:23:46.905 +02:00 [INF] ----- Handling integration event: "8276e1f4-9a79-4b80-a25e-55b72ff1ae19" at IDP.Application - ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","Id":"8276e1f4-9a79-4b80-a25e-55b72ff1ae19","CreationDate":"2021-05-31T23:23:46.6128536Z","$type":"UserRegistrationRequestedIntegrationEvent"})
2021-06-01 01:23:46.992 +02:00 [INF] ----- Begin transaction "6b2b5d36-d035-4dda-b55d-380bf03fa5e3" for IdentifiedCommand<SendCompleteRegistrationEmailCommand> ({"Command":{"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","$type":"SendCompleteRegistrationEmailCommand"},"Id":"8276e1f4-9a79-4b80-a25e-55b72ff1ae19","$type":"IdentifiedCommand`1"})
2021-06-01 01:23:47.007 +02:00 [INF] ----- Sending idempotent command: SendCompleteRegistrationEmailCommand - Id: "8276e1f4-9a79-4b80-a25e-55b72ff1ae19" ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","$type":"SendCompleteRegistrationEmailCommand"})
2021-06-01 01:23:47.025 +02:00 [INF] ----- Validating command SendCompleteRegistrationEmailCommand
2021-06-01 01:23:47.026 +02:00 [INF] ----- Handling internal command SendCompleteRegistrationEmailCommand ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","$type":"SendCompleteRegistrationEmailCommand"})
2021-06-01 01:23:49.726 +02:00 [INF] ----- Internal command SendCompleteRegistrationEmailCommand handled successfully!
2021-06-01 01:23:49.727 +02:00 [INF] ----- Idempotent command succeeded - SendCompleteRegistrationEmailCommand - Id: "8276e1f4-9a79-4b80-a25e-55b72ff1ae19" ({"Subject":"20703fda-66da-492e-b9b0-8e2ec0709b53","$type":"SendCompleteRegistrationEmailCommand"})
2021-06-01 01:23:49.727 +02:00 [INF] ----- Commit transaction "6b2b5d36-d035-4dda-b55d-380bf03fa5e3" for IdentifiedCommand<SendCompleteRegistrationEmailCommand>
